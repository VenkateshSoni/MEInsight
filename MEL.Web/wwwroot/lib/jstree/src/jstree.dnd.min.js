/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/jstree@3.3.8/src/jstree.dnd.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define("jstree.dnd",["jquery","jstree"],e):"object"==typeof exports?e(require("jquery"),require("jstree")):e(jQuery,jQuery.jstree)}(function(e,t,a){"use strict";var r,n;e.jstree.plugins.dnd||(e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},e.jstree.plugins.dnd=function(t,a){this.init=function(e,t){a.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in document.createElement("span")},this.bind=function(){a.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var a=this.get_node(t.target),s=this.is_selected(a)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,i=s>1?s+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(i=e.vakata.html.escape(i)),a&&a.id&&a.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,s>1?this.get_top_selected(!0):[a],t))){if(r={jstree:!0,origin:this,obj:this.get_node(a,!0),nodes:s>1?this.get_top_selected():[a.id]},n=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,r,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+i+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:n,data:r})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:n,data:r}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:n,data:r}),!1},this))},this.redraw_node=function(e,t,r,n){if((e=a.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var s,i,o=null;for(s=0,i=e.childNodes.length;s<i;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){o=e.childNodes[s];break}o&&o.setAttribute("draggable",!0)}return e}},e(function(){var t=!1,s=!1,i=!1,o=!1,d=e('<div id="jstree-marker">&#160;</div>').hide();e(document).on("dragover.vakata.jstree",function(t){n&&e.vakata.dnd._trigger("move",t,{helper:e(),element:n,data:r})}).on("drop.vakata.jstree",function(t){n&&(e.vakata.dnd._trigger("stop",t,{helper:e(),element:n,data:r}),n=null,r=null)}).on("dnd_start.vakata.jstree",function(e,a){t=!1,i=!1,a&&a.data&&a.data.jstree&&d.appendTo(document.body)}).on("dnd_move.vakata.jstree",function(r,n){var l=n.event.target!==i.target;if(o&&(n.event&&"dragover"===n.event.type&&!l||clearTimeout(o)),n&&n.data&&n.data.jstree&&(!n.event.target.id||"jstree-marker"!==n.event.target.id)){i=n.event;var g,c,h,p,_,v,u,f,m,j,y,k,T,w,E,b,x=e.jstree.reference(n.event.target),Y=!1,X=!1,C=!1;if(x&&x._data&&x._data.dnd)if(d.attr("class","jstree-"+x.get_theme()+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")),E=n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(n.event.metaKey||n.event.ctrlKey)),n.helper.children().attr("class","jstree-"+x.get_theme()+" jstree-"+x.get_theme()+"-"+x.get_theme_variant()+" "+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[E?"show":"hide"](),n.event.target!==x.element[0]&&n.event.target!==x.get_container_ul()[0]||0!==x.get_container_ul().children().length){if((Y=x.settings.dnd.large_drop_target?e(n.event.target).closest(".jstree-node").children(".jstree-anchor"):e(n.event.target).closest(".jstree-anchor"))&&Y.length&&Y.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(X=Y.offset(),C=(n.event.pageY!==a?n.event.pageY:n.event.originalEvent.pageY)-X.top,h=Y.outerHeight(),v=C<h/3?["b","i","a"]:C>h-h/3?["a","i","b"]:C>h/2?["i","a","b"]:["i","b","a"],e.each(v,function(a,r){switch(r){case"b":g=X.left-6,c=X.top,p=x.get_parent(Y),_=Y.parent().index();break;case"i":T=x.settings.dnd.inside_pos,w=x.get_node(Y.parent()),g=X.left-2,c=X.top+h/2+1,p=w.id,_="first"===T?0:"last"===T?w.children.length:Math.min(T,w.children.length);break;case"a":g=X.left-6,c=X.top+h,p=x.get_parent(Y),_=Y.parent().index()+1}for(u=!0,f=0,m=n.data.nodes.length;f<m;f++)if(j=n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(n.event.metaKey||n.event.ctrlKey))?"copy_node":"move_node",y=_,"move_node"===j&&"a"===r&&n.data.origin&&n.data.origin===x&&p===x.get_parent(n.data.nodes[f])&&(k=x.get_node(p),y>e.inArray(n.data.nodes[f],k.children)&&(y-=1)),!(u=u&&(x&&x.settings&&x.settings.dnd&&!1===x.settings.dnd.check_while_dragging||x.check(j,n.data.origin&&n.data.origin!==x?n.data.origin.get_node(n.data.nodes[f]):n.data.nodes[f],p,y,{dnd:!0,ref:x.get_node(Y.parent()),pos:r,origin:n.data.origin,is_multi:n.data.origin&&n.data.origin!==x,is_foreign:!n.data.origin})))){x&&x.last_error&&(s=x.last_error());break}var i,C;if("i"===r&&Y.parent().is(".jstree-closed")&&x.settings.dnd.open_timeout&&(n.event&&"dragover"===n.event.type&&!l||(o&&clearTimeout(o),o=setTimeout((i=x,C=Y,function(){i.open_node(C)}),x.settings.dnd.open_timeout))),u)return(b=x.get_node(p,!0)).hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),b.addClass("jstree-dnd-parent")),t={ins:x,par:p,pos:"i"!==r||"last"!==T||0!==_||x.is_loaded(w)?_:"last"},d.css({left:g+"px",top:c+"px"}).show(),n.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),n.event.originalEvent&&n.event.originalEvent.dataTransfer&&(n.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"),s={},v=!0,!1}),!0===v))return}else{for(u=!0,f=0,m=n.data.nodes.length;f<m&&(u=u&&x.check(n.data.origin&&(n.data.origin.settings.dnd.always_copy||n.data.origin.settings.dnd.copy&&(n.event.metaKey||n.event.ctrlKey))?"copy_node":"move_node",n.data.origin&&n.data.origin!==x?n.data.origin.get_node(n.data.nodes[f]):n.data.nodes[f],e.jstree.root,"last",{dnd:!0,ref:x.get_node(e.jstree.root),pos:"i",origin:n.data.origin,is_multi:n.data.origin&&n.data.origin!==x,is_foreign:!n.data.origin}));f++);if(u)return t={ins:x,par:e.jstree.root,pos:"last"},d.hide(),n.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(n.event.originalEvent&&n.event.originalEvent.dataTransfer&&(n.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),t=!1,n.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),n.event.originalEvent&&n.event.originalEvent.dataTransfer,d.hide()}}).on("dnd_scroll.vakata.jstree",function(e,a){a&&a.data&&a.data.jstree&&(d.hide(),t=!1,i=!1,a.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(a,r){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),o&&clearTimeout(o),r&&r.data&&r.data.jstree){d.hide().detach();var n,l,g=[];if(t){for(n=0,l=r.data.nodes.length;n<l;n++)g[n]=r.data.origin?r.data.origin.get_node(r.data.nodes[n]):r.data.nodes[n];t.ins[r.data.origin&&(r.data.origin.settings.dnd.always_copy||r.data.origin.settings.dnd.copy&&(r.event.metaKey||r.event.ctrlKey))?"copy_node":"move_node"](g,t.par,t.pos,!1,!1,!1,r.data.origin)}else(n=e(r.event.target).closest(".jstree")).length&&s&&s.error&&"check"===s.error&&(n=n.jstree(!0))&&n.settings.core.error.call(this,s);i=!1,t=!1}}).on("keyup.jstree keydown.jstree",function(a,r){(r=e.vakata.dnd._get())&&r.data&&r.data.jstree&&("keyup"===a.type&&27===a.which?(o&&clearTimeout(o),t=!1,s=!1,i=!1,o=!1,d.hide().detach(),e.vakata.dnd._clean()):(r.helper.find(".jstree-copy").first()[r.data.origin&&(r.data.origin.settings.dnd.always_copy||r.data.origin.settings.dnd.copy&&(a.metaKey||a.ctrlKey))?"show":"hide"](),i&&(i.metaKey=a.metaKey,i.ctrlKey=a.ctrlKey,e.vakata.dnd._trigger("move",i))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(t,r,n){n===a&&(n=e.vakata.dnd._get()),n.event=r,e(document).triggerHandler("dnd_"+t+".vakata",n)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(document).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(document).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(a){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(!0===a)return!1;var r=t.scroll_e.scrollTop(),n=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(r+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(n+t.scroll_l*e.vakata.dnd.settings.scroll_speed),r===t.scroll_e.scrollTop()&&n===t.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(a,r,n){"touchstart"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{a.currentTarget.unselectable="on",a.currentTarget.onselectstart=function(){return!1},a.currentTarget.style&&(a.currentTarget.style.touchAction="none",a.currentTarget.style.msTouchAction="none",a.currentTarget.style.MozUserSelect="none")}catch(e){}return t.init_x=a.pageX,t.init_y=a.pageY,t.data=r,t.is_down=!0,t.element=a.currentTarget,t.target=a.target,t.is_touch="touchstart"===a.type,!1!==n&&(t.helper=e("<div id='vakata-dnd'></div>").html(n).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(document).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(document).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(a){if("touchmove"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(a.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(a.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo(document.body),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e(t.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",a)}var r=!1,n=!1,s=!1,i=!1,o=!1,d=!1,l=!1,g=!1,c=!1,h=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(a.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var r=e(this),n=r.offset();if(this.scrollHeight>this.offsetHeight&&(n.top+r.height()-a.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),a.pageY-n.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(n.left+r.width()-a.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),a.pageX-n.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l)return t.scroll_e=e(this),!1}),t.scroll_e||(r=e(document),n=e(window),s=r.height(),i=n.height(),o=r.width(),d=n.width(),l=r.scrollTop(),g=r.scrollLeft(),s>i&&a.pageY-l<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),s>i&&i-(a.pageY-l)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),o>d&&a.pageX-g<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),o>d&&d-(a.pageX-g)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=r)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(c=parseInt(a.pageY+e.vakata.dnd.settings.helper_top,10),h=parseInt(a.pageX+e.vakata.dnd.settings.helper_left,10),s&&c+25>s&&(c=s-50),o&&h+t.helper_w>o&&(h=o-(t.helper_w+2)),t.helper.css({left:h+"px",top:c+"px"})),e.vakata.dnd._trigger("move",a),!1}},stop:function(a){if("touchend"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)a.target!==t.target&&e(t.target).off("click.vakata"),e.vakata.dnd._trigger("stop",a);else if("touchend"===a.type&&a.target===t.target){var r=setTimeout(function(){e(a.target).click()},100);e(a.target).one("click",function(){r&&clearTimeout(r)})}return e.vakata.dnd._clean(),!1}}}(e))});
//# sourceMappingURL=/sm/0aa47c8f5ac8d0566323acedb4271f482fa29c1d112be640ede59217fb766c14.map
/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/jstree@3.3.8/src/jstree.search.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define("jstree.search",["jquery","jstree"],e):"object"==typeof exports?e(require("jquery"),require("jstree")):e(jQuery,jQuery.jstree)}(function(e,a,s){"use strict";e.jstree.plugins.search||(e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(a,t){this.bind=function(){t.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(a,s){if(this._data.search.som&&s.res.length){var t,r,h,i,c=this._model.data,n=[];for(t=0,r=s.res.length;t<r;t++)if(c[s.res[t]]&&!c[s.res[t]].state.hidden&&(n.push(s.res[t]),n=n.concat(c[s.res[t]].parents),this._data.search.smc))for(h=0,i=c[s.res[t]].children_d.length;h<i;h++)c[c[s.res[t]].children_d[h]]&&!c[c[s.res[t]].children_d[h]].state.hidden&&n.push(c[s.res[t]].children_d[h]);n=e.vakata.array_remove_item(e.vakata.array_unique(n),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(n,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,a){this._data.search.som&&a.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(a,t,r,h,i,c){if(!1===a||""===e.trim(a.toString()))return this.clear_search();h=(h=this.get_node(h))&&h.id?h.id:null,a=a.toString();var n,d,o=this.settings.search,l=!!o.ajax&&o.ajax,_=this._model.data,u=null,f=[],m=[];if(this._data.search.res.length&&!i&&this.clear_search(),r===s&&(r=o.show_only_matches),c===s&&(c=o.show_only_matches_children),!t&&!1!==l)return e.isFunction(l)?l.call(this,a,e.proxy(function(s){s&&s.d&&(s=s.d),this._load_nodes(e.isArray(s)?e.vakata.array_unique(s):[],function(){this.search(a,!0,r,h,i,c)})},this),h):((l=e.extend({},l)).data||(l.data={}),l.data.str=a,h&&(l.data.inside=h),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=e.ajax(l).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(l)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(s){s&&s.d&&(s=s.d),this._load_nodes(e.isArray(s)?e.vakata.array_unique(s):[],function(){this.search(a,!0,r,h,i,c)})},this)),this._data.search.lastRequest);if(i||(this._data.search.str=a,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=r,this._data.search.smc=c),u=new e.vakata.search(a,!0,{caseSensitive:o.case_sensitive,fuzzy:o.fuzzy}),e.each(_[h||e.jstree.root].children_d,function(e,s){var t=_[s];t.text&&!t.state.hidden&&(!o.search_leaves_only||t.state.loaded&&0===t.children.length)&&(o.search_callback&&o.search_callback.call(this,a,t)||!o.search_callback&&u.search(t.text).isMatch)&&(f.push(s),m=m.concat(t.parents))}),f.length){for(n=0,d=(m=e.vakata.array_unique(m)).length;n<d;n++)m[n]!==e.jstree.root&&_[m[n]]&&!0===this.open_node(m[n],null,0)&&this._data.search.opn.push(m[n]);i?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(f,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(e.jstree.idregex,"\\$&"):a.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(f))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(f,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(e.jstree.idregex,"\\$&"):a.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=f),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:a,res:this._data.search.res,show_only_matches:r})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(e.jstree.idregex,"\\$&"):a.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(a,s,r,h){if((a=t.redraw_node.apply(this,arguments))&&-1!==e.inArray(a.id,this._data.search.res)){var i,c,n=null;for(i=0,c=a.childNodes.length;i<c;i++)if(a.childNodes[i]&&a.childNodes[i].className&&-1!==a.childNodes[i].className.indexOf("jstree-anchor")){n=a.childNodes[i];break}n&&(n.className+=" jstree-search")}return a}},function(e){e.vakata.search=function(a,s,t){t=t||{},!1!==(t=e.extend({},e.vakata.search.defaults,t)).fuzzy&&(t.fuzzy=!0),a=t.caseSensitive?a:a.toLowerCase();var r,h,i,c,n=t.location,d=t.distance,o=t.threshold,l=a.length;return l>32&&(t.fuzzy=!1),t.fuzzy&&(r=1<<l-1,h=function(){var e={},s=0;for(s=0;s<l;s++)e[a.charAt(s)]=0;for(s=0;s<l;s++)e[a.charAt(s)]|=1<<l-s-1;return e}(),i=function(e,a){var s=e/l,t=Math.abs(n-a);return d?s+t/d:t?1:s}),c=function(e){if(e=t.caseSensitive?e:e.toLowerCase(),a===e||-1!==e.indexOf(a))return{isMatch:!0,score:0};if(!t.fuzzy)return{isMatch:!1,score:1};var s,c,d,_,u,f,m,y,p,j=e.length,g=o,x=e.indexOf(a,n),v=l+j,z=1,k=[];for(-1!==x&&(g=Math.min(i(0,x),g),-1!==(x=e.lastIndexOf(a,n+l))&&(g=Math.min(i(0,x),g))),x=-1,s=0;s<l;s++){for(d=0,_=v;d<_;)i(s,n+_)<=g?d=_:v=_,_=Math.floor((v-d)/2+d);for(v=_,f=Math.max(1,n-_+1),m=Math.min(n+_,j)+l,(y=new Array(m+2))[m+1]=(1<<s)-1,c=m;c>=f;c--)if(p=h[e.charAt(c-1)],y[c]=0===s?(y[c+1]<<1|1)&p:(y[c+1]<<1|1)&p|(u[c+1]|u[c])<<1|1|u[c+1],y[c]&r&&(z=i(s,c-1))<=g){if(g=z,x=c-1,k.push(x),!(x>n))break;f=Math.max(1,2*n-x)}if(i(s+1,n)>g)break;u=y}return{isMatch:x>=0,score:z}},!0===s?{search:c}:c(s)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e))});
//# sourceMappingURL=/sm/39ff6818d75241952aac36819d94a402d09d6808e1c877603f8bd04db439434f.map